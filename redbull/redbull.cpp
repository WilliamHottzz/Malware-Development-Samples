// redbull.cpp : This file contains the 'main' function. Program execution begins and ends there.
//

#include <iostream>

#include "redbull.h"



int main()
{   
    DynSystemParameterInfo ChangeWallpaper = nullptr;
    DynGetModuleHandleA ModuleHandleA = nullptr;

    HMODULE kernel32dll = LoadLibraryA("kernel32.dll");
    SleeperSimulation();

    if (kernel32dll != nullptr)
    {
        ModuleHandleA = (DynGetModuleHandleA)GetProcAddress(kernel32dll, "GetModuleHandleA");
    }

    SleeperSimulation();


    auto user32dll = (ModuleHandleA != nullptr) ? ModuleHandleA(User32dllObf().c_str()) : nullptr;


    if (user32dll != nullptr)
    {

        ChangeWallpaper = (DynSystemParameterInfo)GetProcAddress(user32dll, SystemParameterInfoWObf().c_str());

        if (ChangeWallpaper != nullptr)
        {
            ChangeWallpaper(SPI_SETDESKWALLPAPER, 0, (void*)L"DO THE REST YOURSELF", SPIF_UPDATEINIFILE);           
        } 

        FreeLibrary(user32dll);
    }
    
    FreeLibrary(kernel32dll);

    OutputDebugString(L"Hello, World");
}
