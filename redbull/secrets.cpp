#include "secrets.h"



//  Pretty much everything in here is from https://zerosum0x0.blogspot.com/2017/08/obfuscatedencrypted-cc-online-string.html
//  I'm pretty bad on obfuscating myself LOL.



std::string RtlAdjustPrivilegeObf()
{
    unsigned char s[] =
    {

        0x52, 0x73, 0x6a, 0x3e, 0x60, 0x65, 0x6f, 0x6c,
        0x6c, 0x47, 0x68, 0x5e, 0x6a, 0x5c, 0x5e, 0x56,
        0x57, 0x54, 0xee
    };

    for (unsigned int m = 0; m < sizeof(s); ++m)
    {
        unsigned char c = s[m];
        c += m;
        s[m] = c;
    }

    std::string sName(reinterpret_cast<char*>(s));

    return sName;
}


std::string NtQueryInformationProcessObf()
{
    unsigned char s[] =
    {
        0x2b, 0x5, 0x28, 0x4, 0x14, 0x7, 0x0, 0x30,
        0xb, 0x13, 0xa, 0x7, 0xc, 0x18, 0x5, 0x10,
        0xa, 0xb, 0x29, 0x7, 0xa, 0x16, 0x14, 0x6,
        0x6, 0x79
    };

    for (unsigned int m = 0; m < sizeof(s); ++m)
    {
        unsigned char c = s[m];
        c -= 0x79;
        c = -c;
        s[m] = c;
    }

    std::string sName(reinterpret_cast<char*>(s));

    return sName;
}


std::string NtdllObf()
{
    unsigned char s[] =
    {
        0xd7, 0x40, 0x60, 0x20, 0x36, 0x2f, 0xd5, 0x95,
        0xc0, 0x9
    };

    for (unsigned int m = 0; m < sizeof(s); ++m)
    {
        unsigned char c = s[m];
        c = -c;
        c = (c >> 0x3) | (c << 0x5);
        c += 0xd1;
        c = (c >> 0x2) | (c << 0x6);
        c += 0x6f;
        c = (c >> 0x1) | (c << 0x7);
        c ^= m;
        c = ~c;
        c += 0xe6;
        c ^= 0xe0;
        c = (c >> 0x7) | (c << 0x1);
        c += 0x6f;
        c ^= m;
        c = (c >> 0x5) | (c << 0x3);
        s[m] = c;
    }

    std::string sName(reinterpret_cast<char*>(s));

    return sName;
}


std::string NtdllObf2()
{
    return "\x6E""t\144l\x6C"".\144l\x6C""";
}


std::string User32dllObf()
{
    unsigned char s[] =
    {

        0x96, 0x90, 0x7a, 0x8e, 0x1a, 0x1a, 0xfd, 0x72,
        0x74, 0x76, 0xc1
    };

    for (unsigned int m = 0; m < sizeof(s); ++m)
    {
        unsigned char c = s[m];
        c = (c >> 0x1) | (c << 0x7);
        c += 0x2a;
        c ^= m;
        s[m] = c;
    }

    std::string sName(reinterpret_cast<char*>(s));

    return sName;
}


std::string SystemParameterInfoWObf()
{
    unsigned char s[] =
    {

        0x51, 0x77, 0x71, 0x72, 0x63, 0x6b, 0x4e, 0x5f,
        0x70, 0x5f, 0x6b, 0x63, 0x72, 0x63, 0x70, 0x71,
        0x47, 0x6c, 0x64, 0x6d, 0x55, 0xfe
    };

    for (unsigned int m = 0; m < sizeof(s); ++m)
    {
        unsigned char c = s[m];
        c += 0x2;
        s[m] = c;
    }

    std::string sName(reinterpret_cast<char*>(s));

    return sName;
}