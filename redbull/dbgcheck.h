#pragma once

#include <iostream>
#include <windows.h>
#include <cinttypes>
#include <winternl.h>
#include <stdio.h>
#include <Tlhelp32.h>

#include "secrets.h"



enum DebuggerErrorCodes : int
{
	CheckFailed,
	InvalidHandle,
	ImportDllFailed,
	FailedQuery,
	FailedLoadingNtdll
};


enum DebuggerCodes
{
	DebuggerFound = 1,
	StartedUnderDebugger,
	DebuggerFoundASM,
	NoDebuggerFound = -1
};


typedef NTSTATUS(NTAPI* pfnNtQueryInformationProcess)
(
	_In_      HANDLE           ProcessHandle,
	_In_      UINT             ProcessInformationClass,
	_Out_     PVOID            ProcessInformation,
	_In_      ULONG            ProcessInformationLength,
	_Out_opt_ PULONG           ReturnLength
);


int DebugPortCheck();
inline int InlineAsmDebuggerCheck();
inline void DebuggerSoftwareInterrupt();

